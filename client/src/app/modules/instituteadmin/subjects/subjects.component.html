<div
    class="flex min-w-0 flex-auto flex-col bg-gray-100 sm:absolute sm:inset-0 sm:overflow-hidden dark:bg-transparent"
>
    <!-- Header -->
    <div
        class="relative flex flex-0 flex-col px-6 py-6 sm:flex-row sm:items-center sm:justify-between md:px-8"
    >
        <div class="min-w-0 flex-1">
            <!-- Title -->
            <div class="text-4xl font-extrabold tracking-tight">
                {{ gradeName }}
                <mat-icon
                    *ngIf="!gradeName"
                    svgIcon="feather:loader"
                    class="ml-2 animate-spin icon-size-10"
                ></mat-icon>
            </div>
            <div class="text-secondary text-xl">
                {{ 'subjects.page_subtext' | transloco }}
            </div>
        </div>
        <!-- Actions -->
        <div class="mt-6 flex shrink-0 items-center sm:ml-4 sm:mt-0">
            <!-- Search -->
            <mat-form-field
                class="fuse-mat-dense min-w-64 rounded-md"
                [subscriptSizing]="'dynamic'"
            >
                <mat-icon
                    class="icon-size-5"
                    matPrefix
                    [svgIcon]="'heroicons_solid:magnifying-glass'"
                ></mat-icon>
                <input
                    matInput
                    [(ngModel)]="query"
                    (ngModelChange)="applyFilter()"
                    [autocomplete]="'off'"
                    [placeholder]="'common.search' | transloco"
                />
            </mat-form-field>
        </div>
    </div>

    <!-- Main -->
    <div class="flex flex-auto overflow-hidden">
        <div class="flex flex-auto flex-col overflow-hidden sm:overflow-y-auto">
            <div class="overflow-x-auto p-4">
                <table
                    mat-table
                    [dataSource]="dataSource"
                    matSort
                    [hidden]="dataSource.data.length === 0"
                    class="w-full overflow-hidden rounded-lg border border-gray-300 shadow-sm"
                >
                    <ng-container matColumnDef="subject_name">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>
                            {{ 'subjects.header_name' | transloco }}
                        </th>
                        <td mat-cell *matCellDef="let element">
                            <a
                                class="text-primary"
                                routerLink="{{ element.id + '/chapters' }}"
                                >{{ element.subject_name }}</a
                            >
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="createdAt">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>
                            {{ 'subjects.header_created_on' | transloco }}
                        </th>
                        <td mat-cell *matCellDef="let element">
                            {{ element.createdAt | date }}
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="updatedAt">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>
                            {{ 'subjects.header_modified_on' | transloco }}
                        </th>
                        <td mat-cell *matCellDef="let element">
                            {{ element.updatedAt | date }}
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="chapter_count">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>
                            {{ 'subjects.header_chapter_count' | transloco }}
                        </th>
                        <td mat-cell *matCellDef="let element">
                            {{ element.chapter_count ?? '-' }}
                        </td>
                    </ng-container>

                    <!-- Header & Row Declarations -->
                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr
                        mat-row
                        *matRowDef="let row; columns: displayedColumns"
                    ></tr>

                    <!-- No Records Message -->
                    <tr class="mat-row" *matNoDataRow>
                        <td
                            class="mat-cell"
                            [attr.colspan]="displayedColumns.length"
                        >
                            <div class="p-6 text-center text-xl tracking-tight">
                                {{ 'common.noRecordsFound' | transloco }}
                                <span class="font-semibold">"{{ query }}"</span>
                            </div>
                        </td>
                    </tr>
                </table>

                <mat-paginator
                    [ngClass]="{ hidden: dataSource.data.length === 0 }"
                    class="z-10 mt-5 rounded-md border-b bg-white"
                    [pageSize]="10"
                    [pageSizeOptions]="[5, 10, 25, 50]"
                    showFirstLastButtons
                >
                </mat-paginator>

                <ng-container *ngIf="dataSource.data.length === 0">
                    <ng-container *ngTemplateOutlet="noData"></ng-container>
                </ng-container>
            </div>
        </div>
    </div>
</div>

<ng-template #noData>
    <div class="p-8 text-center text-4xl tracking-tight">
        <div class="flex w-full justify-center">
            <img src="images/no-data.svg" alt="No data" class="w-90" />
        </div>
        <div class="mt-5 text-center text-4xl font-extrabold">
            {{ 'common.noDataAvailable' | transloco }}
        </div>
        <div
            class="text-secondary mt-2 text-center text-lg font-medium tracking-tight md:text-xl"
        >
            {{ 'subjects.empty_state_line1' | transloco }} <br />
            {{ 'subjects.empty_state_line2' | transloco }}
        </div>
    </div>
</ng-template>
